(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{298:function(e,t,a){e.exports=a(605)},319:function(e,t){},326:function(e,t){},327:function(e,t){},329:function(e,t){},363:function(e,t){},365:function(e,t){},366:function(e,t){},372:function(e,t){},375:function(e,t){},395:function(e,t){},398:function(e,t){},415:function(e,t){},418:function(e,t){},459:function(e,t){},468:function(e,t){},470:function(e,t){},472:function(e,t,a){},605:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(25),i=a.n(r),c=a(30),o=a.n(c),l=a(63),u=a(44),m=a(45),g=a(47),p=a(46),d=a(48),h=a(29),f=a(64),b=a.n(f),v=(a(472),a(220)),x=a(8),E=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(g.a)(this,Object(p.a)(t).call(this,e))).handleNewMessage=function(e){e.length<=140&&a.setState({message:e})},a.submitMessage=function(){a.props.submitMessage(a.state.message),a.setState({message:""})},a.state={message:""},a}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return s.a.createElement(x.c,{container:!0,alignItems:"center",direction:"column",className:this.props.classes.root},s.a.createElement(x.c,{item:!0},s.a.createElement(x.g,{variant:"h4",className:this.props.classes.lightTextColor},"BOND WITH FRIENDS")),s.a.createElement(x.c,{item:!0},s.a.createElement(x.e,{className:this.props.classes.paper,elevation:1},s.a.createElement("form",{className:t.container,noValidate:!0,autoComplete:"off"},s.a.createElement(x.f,{className:this.props.classes.input,id:"outlined-multiline-flexible",label:"Make Your Bond",onChange:function(t){return e.handleNewMessage(t.target.value)},value:this.state.message,multiline:!0,fullWidth:!0,rowsMax:"4",margin:"normal",variant:"outlined"}),s.a.createElement(x.f,{id:"date",label:"Set Your Bond",type:"date",fullWidth:!0,defaultValue:"2017-05-24",className:t.textField,InputLabelProps:{shrink:!0}}),"c",s.a.createElement(x.g,{variant:"h5"},"Add Your Friends:"),s.a.createElement(x.f,{id:"standard-name",label:"Friend 1",className:t.textField,value:this.state.name,margin:"normal"}),s.a.createElement(x.f,{id:"standard-name",label:"Friend 2",className:t.textField,value:this.state.name,margin:"normal"}),s.a.createElement(x.f,{id:"standard-name",label:"Friend 3",className:t.textField,value:this.state.name,margin:"normal"}),s.a.createElement(x.f,{id:"standard-name",label:"Friend 4",className:t.textField,value:this.state.name,margin:"normal"}),s.a.createElement(x.f,{id:"standard-name",label:"Friend 5",className:t.textField,value:this.state.name,margin:"normal"}),s.a.createElement(x.f,{id:"standard-name",label:"Stake",fullWidth:!0,className:t.textField,value:this.state.name,margin:"normal"})),s.a.createElement("div",{className:this.props.classes.submit},s.a.createElement(x.a,{variant:"outlined",color:"primary",className:this.props.classes.button,onClick:this.submitMessage,disabled:""===this.state.message},"Stake Your Bond")),this.props.submittingMessage?s.a.createElement(x.d,null):null)))}}]),t}(n.Component),j=Object(h.withStyles)(function(e){return{lightTextColor:{color:"#eaeaea"},margin:{margin:e.spacing.unit},input:{marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit},paper:Object(v.a)({},e.mixins.gutters(),{paddingTop:2*e.spacing.unit,paddingBottom:2*e.spacing.unit,maxWidth:600,marginTop:4*e.spacing.unit}),root:{backgroundColor:"#282c34",padding:50},submit:{textAlign:"center",marginBottom:8}}})(E),w=function(e){function t(){return Object(u.a)(this,t),Object(g.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=Object.keys(this.props.messages).slice(0).reverse().map(function(t){var a=e.props.messages[t],n=a.text,r=a.isPending?"PENDING":"CONFIRMED";return s.a.createElement(x.c,{item:!0,key:t,className:e.props.classes.messageContainer},s.a.createElement(x.g,{variant:"h5",className:e.props.classes.message},'"',n,'"'),s.a.createElement(x.g,{variant:"caption",noWrap:!0},"Transaction Status: ",s.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://mastery.aion.network/#/transaction/".concat(t)},r)))});0===t.length&&t.push(s.a.createElement(x.c,{item:!0,key:"noMessages",className:this.props.classes.messageContainer},s.a.createElement(x.g,{align:"center",variant:"h5",className:this.props.classes.message},"No Messages")));var a=s.a.createElement(x.b,null);return s.a.createElement(x.c,{container:!0,alignItems:"center",direction:"column"},s.a.createElement(x.c,{item:!0,xs:6,className:this.props.classes.header},s.a.createElement(x.g,{variant:"h5"},"Resolutiobs in last 1000 blocks:")),this.props.loadingMessages?a:t)}}]),t}(n.Component),N=Object(h.withStyles)(function(e){return{header:{margin:3*e.spacing.unit},message:{fontWeight:100,marginBottom:e.spacing.unit},messageContainer:{marginBottom:4*e.spacing.unit,width:"80%",maxWidth:600,textAlign:"center"}}})(w),O=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(g.a)(this,Object(p.a)(t).call(this,e))).submitMessage=function(){var e=Object(l.a)(o.a.mark(function e(t){var n,s,r,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({submittingMessage:!0}),e.next=3,fetch("/submitRecord",{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/html"},body:JSON.stringify({message:t})});case 3:return n=e.sent,e.next=6,n.json();case 6:"success"===(s=e.sent).status?((r=Object.assign({},a.state.messages))[s.hash]={text:t,isPending:!0},a.setState({messages:r}),console.log("Message submitted: ".concat(s.url)),i=a.accountInterval=window.setInterval(function(){a.checkTransactionStatus(i,s.hash,t)},1e3)):console.error("Unexpected error when submitting the message."),a.setState({submittingMessage:!1});case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.checkTransactionStatus=function(){var e=Object(l.a)(o.a.mark(function e(t,n,s){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getContractInfo();case 2:r=e.sent,new b.a(new b.a.providers.HttpProvider(r.endpoint)).eth.getTransactionReceipt(n,function(e,r){if(e&&(console.error(e),clearInterval(t)),r&&r.status){var i=Object.assign({},a.state.messages);i[n]={text:s,isPending:!1},a.setState({messages:i}),clearInterval(t)}});case 5:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.getContractInfo=Object(l.a)(o.a.mark(function e(){var t,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/contractInfo",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,console.log(t),e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)})),a.componentDidMount=function(){Object(l.a)(o.a.mark(function e(){var t,n,s,r,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loadingMessages:!0}),e.next=3,a.getContractInfo();case 3:return t=e.sent,n=new b.a(new b.a.providers.HttpProvider(t.endpoint)),s=new n.eth.Contract(t.abi,t.address),e.next=8,n.eth.getBlockNumber();case 8:r=e.sent,i=(r-1e3).toString(),s.getPastEvents("AllResolutions",{fromBlock:i,toBlock:"latest"},function(e,t){var n={};e?console.log("An unexpected error occurred when reading event logs: ".concat(e)):(t.forEach(function(e){n[e.transactionHash]={text:e.returnValues.message,isPending:!1}}),a.setState({messages:n})),a.setState({loadingMessages:!1})});case 11:case"end":return e.stop()}},e,this)}))()},a.state={messages:{},loadingMessages:!1,submittingMessage:!1},a}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:this.props.classes.root},s.a.createElement(j,{submitMessage:this.submitMessage,submittingMessage:this.state.submittingMessage}),s.a.createElement(N,{messages:this.state.messages,transactionHashes:this.state.transactionHashes,loadingMessages:this.state.loadingMessages}),s.a.createElement("div",{className:this.props.classes.flex}))}}]),t}(n.Component),M=Object(h.withStyles)(function(e){return{root:{display:"flex",flexDirection:"column",minHeight:"100vh"},flex:{flex:1},footer:{textAlign:"center",padding:8}}})(O);i.a.render(s.a.createElement(M,null),document.getElementById("root"))}},[[298,2,1]]]);
//# sourceMappingURL=main.6c2efd19.chunk.js.map